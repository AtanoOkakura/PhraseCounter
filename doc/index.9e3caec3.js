const t=window.SpeechRecognition||window.webkitSpeechRecognition,e=window.SpeechGrammarList||window.webkitSpeechGrammarList;window.SpeechRecognitionEvent||window.webkitSpeechRecognitionEvent;class n{constructor(n,i){this.callback=i,this.recognition=new t,this.recognitionList=new e,this.setPhrase(n),this.recognition.lang="ja-JP",this.recognition.interimResults=!1,this.recognition.maxAlternatives=5,this.recognition.onresult=this.onresult.bind(this),this.recognition.onend=this.onend.bind(this),this.recognition.onstart=o.bind(this),this.cnt=0,this.start()}oncountchange(t){this.callback&&this.callback(this.phrase,t)}setPhrase(t){console.log("setPhrase: "+t),this.phrase=t;let e="#JSGF V1.0; grammar phrase; public <phrase> = "+t.toLowerCase()+";";this.recognitionList.addFromString(e,1),this.recognition.grammars=this.recognitionList}setCount(t){this.cnt!==t&&(console.log("count changed: "+t),this.oncountchange(t),this.cnt=t)}onresult(t){let e=0;var n=t.results[0][0].transcript.toLowerCase();console.log("result: "+n);let o=RegExp(this.phrase,"gm"),i=n.match(o);if(null!==i){let t=i[0]+"って言いました！";e=i.length,console.log(t+this.cnt)}else console.log("これは口癖ではありません");console.log("current count: "+this.cnt),console.log("tempCnt: "+e),this.setCount(this.cnt+e),this.callback&&this.callback(this.phrase,this.cnt,n),console.log("話した内容: "+n)}onend(){this.running=!1,console.log("SpeechRecognition.onend"),console.log("restart recognition"),this.start()}start(){this.running||(this.recognition.start(),this.running=!0)}}function o(t){console.log("SpeechRecognition.onstart")}class i{constructor(t){let e=document.querySelector("h1#title"),n=document.querySelector("#ok"),o=document.querySelector("input#phrase-input"),i=document.querySelector("input#count-input");null!==e&&null!==n&&null!==o&&null!==i?(this.phraseCounter=t,this.title=e,this.ok=n,this.phrase_i=o,this.count_i=i):console.error("FormManagerの初期化に失敗しました"),this.onSubmit=this.onSubmit.bind(this),this.ok.addEventListener("click",this.onSubmit)}onSubmit(){console.log("ok button clicked");let t=this.phrase_i.value,e=parseInt(this.count_i.value)||0;this.phraseCounter.setPhrase(t),this.phraseCounter.setCount(e),this.title.textContent=t.split("|")[0]+"カウンター"}}addEventListener("load",()=>{let t,e,o;t=document.querySelector("#counter"),e=document.querySelector("#talk"),o=new n("口癖",function(n,o,i){t&&e&&(i&&(e.textContent=i),t.textContent=o+"")}),new i(o),o.start()});
//# sourceMappingURL=index.9e3caec3.js.map
